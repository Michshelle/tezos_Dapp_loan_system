(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{146:function(e,t,a){e.exports=a(347)},157:function(e,t){},159:function(e,t){},222:function(e,t){},224:function(e,t){},253:function(e,t){},254:function(e,t){},343:function(e,t,a){},344:function(e,t,a){},347:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(50),s=a.n(c),o=a(11),l=a.n(o),i=a(19),u=a(15),m=a(23),d=a(144),p=a(145),f=a.n(p),b=function(e){var t=e.tokenInstance,a=(e.ledgerInstance,e.ledgerInfo,e.userAddress),c=e.setBalance,s=e.Tezos,o=Object(n.useState)(null),m=Object(u.a)(o,2),d=m[0],p=m[1],b=Object(n.useState)(void 0),v=Object(u.a)(b,2),g=v[0],E=v[1],h=function(){var e=Object(i.a)(l.a.mark((function e(t,a,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(i.a)(l.a.mark((function e(a){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.methods.burn(a);case 3:if(n=e.sent,console.log(n),"applied"!==n.status){e.next=10;break}p("applied"),E(n.hash),e.next=12;break;case 10:throw p("error"),Error("Transation not applied");case 12:return e.next=14,n.confirmation(30);case 14:if(n.includedInBlock===1/0){e.next=22;break}return p("included"),e.next=18,s.tz.getBalance(a);case 18:r=e.sent,c(r),e.next=23;break;case 22:throw Error("Transation not included in block");case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),console.log(e.t0);case 28:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(t){return e.apply(this,arguments)}}();return null===d?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"app-subtitle"},"Choose the action you want to perform:"),r.a.createElement("div",{className:"card coffee_selection",key:a},r.a.createElement("div",{className:"card-footer"},r.a.createElement("div",{className:"card-footer-item"},r.a.createElement("span",{className:"action",onClick:function(){return k(a)}},"Burn")),r.a.createElement("div",{className:"card-footer-item"},r.a.createElement("p",{className:"card-padding-line"},"New creditor: ",r.a.createElement("input",{type:"text",id:"newCreditorAccount",value:""})),r.a.createElement("p",{className:"card-padding-line"},"Date: ",r.a.createElement(f.a,null)),r.a.createElement("span",{className:"action",onClick:function(){return h(a,document.getElementById("newCreditorAccount").value)}},"Transfer"))))):"applied"===d?r.a.createElement("div",{className:"message is-info"},r.a.createElement("div",{className:"message-header"},r.a.createElement("p",null,"Waiting for confirmation")),r.a.createElement("div",{className:"message-body"},r.a.createElement("p",null,"Your transaction is being processed, please wait."),r.a.createElement("p",{className:"coffee-loader"},r.a.createElement("img",{src:"coffee-cup.png",alt:"coffee-cup"})),r.a.createElement("p",null,"Transaction number: ",g))):"included"===d?r.a.createElement("div",{className:"message is-success"},r.a.createElement("div",{className:"message-header"},r.a.createElement("p",null,"Transaction confirmed!")),r.a.createElement("div",{className:"message-body"},r.a.createElement("p",null,"Xtz has been sent to your account"),r.a.createElement("br",null),r.a.createElement("p",null,r.a.createElement("button",{className:"button is-info",onClick:function(){return p(null)}},"Xtz redeem")))):"error"===d?r.a.createElement("div",{className:"message is-danger"},r.a.createElement("div",{className:"message-header"},r.a.createElement("p",null,"Error")),r.a.createElement("div",{className:"message-body"},r.a.createElement("p",null,"An error has occurred, please try again."))):void 0},v=(a(343),a(344),"KT1GxBkvP5aiAtBu9MwAWBgxRpaCeLCcBfNj"),g=function(){var e,t=Object(n.useState)(void 0),c=Object(u.a)(t,2),s=c[0],o=c[1],p=Object(n.useState)(void 0),f=Object(u.a)(p,2),g=f[0],E=f[1],h=Object(n.useState)(void 0),k=Object(u.a)(h,2),x=k[0],N=k[1],w=Object(n.useState)(void 0),j=Object(u.a)(w,2),O=j[0],y=j[1],B=Object(n.useState)(void 0),C=Object(u.a)(B,2),I=C[0],S=C[1],z=Object(n.useState)(void 0),T=Object(u.a)(z,2),A=T[0],F=T[1],X=Object(n.useState)(!1),L=Object(u.a)(X,2),W=L[0],M=L[1],Y=Object(n.useState)(0),q=Object(u.a)(Y,2),D=(q[0],q[1]),J=window.tezbridge,K=function(){var e=Object(i.a)(l.a.mark((function e(){var t,n,r,c,o,i,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=a(345),e.next=4,t("https://api-pub.bitfinex.com/v2/ticker/tXTZUSD");case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,c=Number(r[0]),E(c),e.next=12,J.request({method:"get_source"});case 12:return o=e.sent,S(o),e.next=16,m.a.tz.getBalance(o);case 16:return i=e.sent,F(i),e.next=20,s.storage();case 20:if(e.sent.owner!==o){e.next=27;break}return M(!0),e.next=25,m.a.tz.getBalance(v);case 25:u=e.sent,D(u.c[0]);case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(0),console.log("error fetching the address or balance:",e.t0);case 32:case"end":return e.stop()}}),e,null,[[0,29]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(i.a)(l.a.mark((function e(t,a){var n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t/1e6/a,e.next=3,s.methods.mint(t).send({amount:n.toFixed(4)});case 3:return r=e.sent,e.next=6,r.confirmation(30);case 6:if(r.includedInBlock===1/0){e.next=13;break}return e.next=9,m.a.tz.getBalance(I);case 9:c=e.sent,F(c),e.next=14;break;case 13:console.log("error");case 14:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){Object(i.a)(l.a.mark((function e(){var t,a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m.a.setProvider({rpc:"https://tezos-dev.cryptonomic-infra.tech",signer:new d.a}),e.next=3,m.a.contract.at(v);case 3:return t=e.sent,o(t),e.next=7,m.a.contract.at("KT1RigSYegqvkCkEoHMfgXY4XLgknZufrFEa");case 7:return a=e.sent,N(a),e.next=11,a.storage();case 11:n=e.sent,r=[n.debtor,n.totalCredit],y(r);case 14:case"end":return e.stop()}}),e)})))()}),[]),r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"wallet"},void 0===A?r.a.createElement("button",{className:"button is-info is-light is-small",onClick:K},"Connect your wallet"):r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"balance"},"\ua729 ",A.toNumber()/1e6),r.a.createElement("div",{className:"field is-grouped"},r.a.createElement("p",{className:"control"},r.a.createElement("button",{className:"button is-success is-light is-small",onClick:Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(void 0),F(void 0),M(void 0),E(void 0),e.next=6,K();case 6:case"end":return e.stop()}}),e)})))},(e=I).slice(0,6)+"..."+e.slice(e.length-6))),W&&r.a.createElement("p",{className:"control"},r.a.createElement("button",{className:"button is-warning is-light is-small",onClick:Object(i.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:P(document.getElementById("tokenNumber").value,g),document.getElementById("tokenNumber").value="";case 2:case"end":return e.stop()}}),e)})))},"Mint token"),r.a.createElement("input",{type:"text",id:"tokenNumber"}))))),r.a.createElement("div",{className:"app-title"},"Flexible Loans"),r.a.createElement("div",{className:"logo"},r.a.createElement("img",{src:"coffee-maker.png",alt:"logo"})),"undefined"===typeof O?"Loading the ledger info...":r.a.createElement(b,{ledgerInfo:O,tokenInstance:s,ledgerInstance:x,userAddress:I,setBalance:F,Tezos:m.a}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},96:function(e,t){}},[[146,1,2]]]);
//# sourceMappingURL=main.25f0cc7b.chunk.js.map
{"ast":null,"code":"import _regeneratorRuntime from\"/Users/shengyisong/Documents/githubs/tezos-react-tutorial/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/shengyisong/Documents/githubs/tezos-react-tutorial/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/shengyisong/Documents/githubs/tezos-react-tutorial/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import DateTimePicker from'react-datetime-picker';//const { JSDOM } = require( \"jsdom\" );\n//const { window } = new JSDOM( \"\" );\n//const $ = require( \"jquery\" )( window );\nvar upperFirst=function upperFirst(str){return str[0].toUpperCase()+str.slice(1);};var mutezToTez=function mutezToTez(mutez){return Math.round((parseInt(mutez)/1000000+Number.EPSILON)*100)/100;};var Menu=function Menu(_ref){var tokenInstance=_ref.tokenInstance,ledgerInstance=_ref.ledgerInstance,ledgerInfo=_ref.ledgerInfo,userAddress=_ref.userAddress,setBalance=_ref.setBalance,Tezos=_ref.Tezos;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),txStatus=_useState2[0],setTxStatus=_useState2[1];var _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),txHash=_useState4[0],setTxHash=_useState4[1];var debtTokenTransfer=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userAddress,new_owner,start_date){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:try{}catch(error){console.log(error);}case 1:case\"end\":return _context.stop();}}},_callee);}));return function debtTokenTransfer(_x,_x2,_x3){return _ref2.apply(this,arguments);};}();var burn=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(userAddress){var op,newBalance;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return tokenInstance.methods.burn(userAddress);case 3:op=_context2.sent;console.log(op);if(!(op.status===\"applied\")){_context2.next=10;break;}setTxStatus(\"applied\");setTxHash(op.hash);_context2.next=12;break;case 10:setTxStatus(\"error\");throw Error(\"Transation not applied\");case 12:_context2.next=14;return op.confirmation(30);case 14:if(!(op.includedInBlock!==Infinity)){_context2.next=22;break;}setTxStatus(\"included\");_context2.next=18;return Tezos.tz.getBalance(userAddress);case 18:newBalance=_context2.sent;setBalance(newBalance);_context2.next=23;break;case 22:throw Error(\"Transation not included in block\");case 23:_context2.next=28;break;case 25:_context2.prev=25;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 28:case\"end\":return _context2.stop();}}},_callee2,null,[[0,25]]);}));return function burn(_x4){return _ref3.apply(this,arguments);};}();if(txStatus===null){return React.createElement(React.Fragment,null,React.createElement(\"div\",{className:\"app-subtitle\"},\"Choose the action you want to perform:\"),React.createElement(\"div\",{className:\"card coffee_selection\",key:userAddress},React.createElement(\"div\",{className:\"card-footer\"},React.createElement(\"div\",{className:\"card-footer-item\"},React.createElement(\"span\",{className:\"action\",onClick:function onClick(){return burn(userAddress);}},\"Burn\")),React.createElement(\"div\",{className:\"card-footer-item\"},React.createElement(\"p\",{className:\"card-padding-line\"},\"New creditor: \",React.createElement(\"input\",{type:\"text\",id:\"newCreditorAccount\",value:\"\"})),React.createElement(\"p\",{className:\"card-padding-line\"},\"Date: \",React.createElement(DateTimePicker,null)),React.createElement(\"span\",{className:\"action\",onClick:function onClick(){return debtTokenTransfer(userAddress,document.getElementById(\"newCreditorAccount\").value);}},\"Transfer\")))));}else if(txStatus===\"applied\"){return React.createElement(\"div\",{className:\"message is-info\"},React.createElement(\"div\",{className:\"message-header\"},React.createElement(\"p\",null,\"Waiting for confirmation\")),React.createElement(\"div\",{className:\"message-body\"},React.createElement(\"p\",null,\"Your transaction is being processed, please wait.\"),React.createElement(\"p\",{className:\"coffee-loader\"},React.createElement(\"img\",{src:\"coffee-cup.png\",alt:\"coffee-cup\"})),React.createElement(\"p\",null,\"Transaction number: \",txHash)));}else if(txStatus===\"included\"){return React.createElement(\"div\",{className:\"message is-success\"},React.createElement(\"div\",{className:\"message-header\"},React.createElement(\"p\",null,\"Transaction confirmed!\")),React.createElement(\"div\",{className:\"message-body\"},React.createElement(\"p\",null,\"Xtz has been sent to your account\"),React.createElement(\"br\",null),React.createElement(\"p\",null,React.createElement(\"button\",{className:\"button is-info\",onClick:function onClick(){return setTxStatus(null);}},\"Xtz redeem\"))));}else if(txStatus===\"error\"){return React.createElement(\"div\",{className:\"message is-danger\"},React.createElement(\"div\",{className:\"message-header\"},React.createElement(\"p\",null,\"Error\")),React.createElement(\"div\",{className:\"message-body\"},React.createElement(\"p\",null,\"An error has occurred, please try again.\")));}};export default Menu;","map":{"version":3,"sources":["/Users/shengyisong/Documents/githubs/tezos-react-tutorial/client/src/Menu.js"],"names":["React","useState","DateTimePicker","upperFirst","str","toUpperCase","slice","mutezToTez","mutez","Math","round","parseInt","Number","EPSILON","Menu","tokenInstance","ledgerInstance","ledgerInfo","userAddress","setBalance","Tezos","txStatus","setTxStatus","undefined","txHash","setTxHash","debtTokenTransfer","new_owner","start_date","error","console","log","burn","methods","op","status","hash","Error","confirmation","includedInBlock","Infinity","tz","getBalance","newBalance","document","getElementById","value"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport DateTimePicker from 'react-datetime-picker';\n//const { JSDOM } = require( \"jsdom\" );\n//const { window } = new JSDOM( \"\" );\n//const $ = require( \"jquery\" )( window );\n\nconst upperFirst = str => str[0].toUpperCase() + str.slice(1);\n\nconst mutezToTez = mutez =>\n  Math.round((parseInt(mutez) / 1000000 + Number.EPSILON) * 100) / 100;\n\nconst Menu = ({\n  tokenInstance,\n  ledgerInstance,\n  ledgerInfo,\n  userAddress,\n  setBalance,\n  Tezos\n}) => {\n  const [txStatus, setTxStatus] = useState(null);\n  const [txHash, setTxHash] = useState(undefined);\n\n  const debtTokenTransfer = async (userAddress,new_owner,start_date) => {\n    try {\n\n\n\n    } catch (error) {\n      console.log(error);\n    }\n\n  }\n\n  const burn = async (userAddress) => {\n    try {\n\n      const op = await tokenInstance.methods\n        .burn(userAddress)\n      console.log(op);\n      if (op.status === \"applied\") {\n        setTxStatus(\"applied\");\n        setTxHash(op.hash);\n      } else {\n        setTxStatus(\"error\");\n        throw Error(\"Transation not applied\");\n      }\n\n      await op.confirmation(30);\n      if (op.includedInBlock !== Infinity) {\n        setTxStatus(\"included\");\n        const newBalance = await Tezos.tz.getBalance(userAddress);\n        setBalance(newBalance);\n      } else {\n        throw Error(\"Transation not included in block\");\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  if (txStatus === null) {\n\n    return (\n      <>\n        <div className=\"app-subtitle\">Choose the action you want to perform:</div>\n          <div className=\"card coffee_selection\" key={userAddress}>\n              <div className=\"card-footer\">\n                <div className=\"card-footer-item\">\n                  <span\n                    className=\"action\"\n                    onClick={() => burn(userAddress)}\n                  >\n                    Burn\n                  </span>            \n                </div>\n                <div className=\"card-footer-item\">\n                  <p className=\"card-padding-line\">\n                   New creditor: <input type=\"text\" id=\"newCreditorAccount\" value=\"\"></input>\n                  </p>\n                  <p className=\"card-padding-line\">\n                  Date: <DateTimePicker           />\n                  </p>\n                  <span\n                    className=\"action\"\n                    onClick={() => debtTokenTransfer(userAddress,document.getElementById(\"newCreditorAccount\").value)}\n                  >\n                    Transfer\n                    </span>                             \n                </div>\n              </div>\n          </div>\n      </>\n    );\n  } else if (txStatus === \"applied\") {\n    return (\n      <div className=\"message is-info\">\n        <div className=\"message-header\">\n          <p>Waiting for confirmation</p>\n        </div>\n        <div className=\"message-body\">\n          <p>Your transaction is being processed, please wait.</p>\n          <p className=\"coffee-loader\">\n            <img src=\"coffee-cup.png\" alt=\"coffee-cup\" />\n          </p>\n          <p>Transaction number: {txHash}</p>\n        </div>\n      </div>\n    );\n  } else if (txStatus === \"included\") {\n    return (\n      <div className=\"message is-success\">\n        <div className=\"message-header\">\n          <p>Transaction confirmed!</p>\n        </div>\n        <div className=\"message-body\">\n          <p>Xtz has been sent to your account</p>\n          <br />\n          <p>\n            <button\n              className=\"button is-info\"\n              onClick={() => setTxStatus(null)}\n            >\n              Xtz redeem\n            </button>\n          </p>\n        </div>\n      </div>\n    );\n  } else if (txStatus === \"error\") {\n    return (\n      <div className=\"message is-danger\">\n        <div className=\"message-header\">\n          <p>Error</p>\n        </div>\n        <div className=\"message-body\">\n          <p>An error has occurred, please try again.</p>\n        </div>\n      </div>\n    );\n  }\n};\n\nexport default Menu;\n"]},"metadata":{},"sourceType":"module"}